# UD7 HMI Convert v1.2.3

本工具專為 漢鼎 UD7 系列驅動器監控軟體，監控數據之 CSV 資料進行整併、篩選與圖表分析設計，目標是 **「簡化工程流程，加速資料處理」**，快速完成數據整合、視覺化與報表輸出。

---

## 開發背景

1. 解決手動處理與判讀追頻資料繁瑣、容易出錯的問題，提升處理準確率與效率。

2. 對象涵蓋具工程背景但不熟悉程式語言之使用者，因此採用單一腳本 + 圖形化界面（Tkinter）形式，方便點擊操作。

3. 使用者只需選擇資料夾、設定時間區間與資料欄位，即可一鍵完成分析報告與圖表輸出。

---

## 功能總覽

1. 內建 Tkinter GUI 視覺化操作界面，無需編程背景即可使用。

2. 批次合併 `.csv` 驅動器監控資料資料，支援 `FREQ (頻率)`、`IFB (電流)`、`VFB (功率)` 三種欄位選擇。

3. 自動依據 `追頻啟動` 與 `停止命令` 特徵訊號切分資料。

4. 圖表以 `matplotlib` 實時預覽，或匯出至 Excel 完整呈現。

5. 每組追頻資料自動命名工作表，並在 Excel 中對應繪製多組雙 Y 軸圖表。

6. 內建錯誤追蹤機制，自動辨識未正常停止、錯誤警報與異常切換。

---

## 操作方式

1. 執行主程式（例如 `UD7_HMI_convert_v1.2.3 (UI).py`）。

2. 點選「瀏覽」，選擇包含 UD7系列監控資料之 `.CSV` 檔案的資料夾。

3. 設定「搜尋時間區間」與欲輸出的資料欄位（FREQ / IFB / VFB）。

4. 點擊：
   - 「**預覽**」→ 以 `matplotlib` 顯示即時圖形。
   - 「**執行**」→ 匯出含圖表之 Excel 報表。

5. 執行完成後，報表將自動儲存為 `UD7_HMI_Output.xlsx`，並保存在資料來源資料夾內。

---

## 注意事項

1. 請勿在 Excel 檔案開啟狀態下執行「執行」功能，否則可能導致儲存失敗。

2. 每次操作僅處理一組資料夾內容，請確認 CSV 格式符合原始設備輸出結構。

3. 若系統偵測到下列情況，將跳出提示訊息：
   - UD7 Alarm 警報
   - 操作模式切換異常
   - 驅動器/HMI 程式未正常關閉
   - 提示訊息不影響資料合併

4. 匯出圖表為雙 Y 軸設計，最多支援 FREQ、IFB、VFB 三種欄位並行顯示。

---

## 執行需求

- 作業系統：Windows（建議搭配中文化環境）

- Python 3.8 以上版本

- 相依套件：
  - `tkinter`
  - `tkcalendar`
  - `openpyxl==3.1.3`
  - `matplotlib`

---
